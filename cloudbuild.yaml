options:
  logging: CLOUD_LOGGING_ONLY

steps:
  # Deploy authCallback function
  - name: 'gcr.io/cloud-builders/gcloud'
    entrypoint: 'bash'
    args:
      - '-c'
      - |
        gcloud functions deploy authCallback \
          --runtime=nodejs20 \
          --trigger-http \
          --region=europe-west2 \
          --allow-unauthenticated \
          --source=. \
          --entry-point=authCallback \
          --service-account=flair-december-2024@appspot.gserviceaccount.com

  # Deploy adminDashboard function
  - name: 'gcr.io/cloud-builders/gcloud'
    entrypoint: 'bash'
    args:
      - '-c'
      - |
        gcloud functions deploy adminDashboard \
          --runtime=nodejs20 \
          --trigger-http \
          --region=europe-west2 \
          --allow-unauthenticated \
          --source=. \
          --entry-point=adminDashboard \
          --service-account=flair-december-2024@appspot.gserviceaccount.com